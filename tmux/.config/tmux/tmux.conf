# # vim style tmux .config
# bind ^X lock-server
# bind ^C new-window -c "$HOME"
# bind ^D detach
# bind * list-clients
#
# bind H previous-window
# bind L next-window
#
# bind r command-prompt "rename-window %%"
# bind ^A last-window
# bind ^W list-windows
# bind w list-windows
# bind z resize-pane -Z
# bind ^L refresh-client
# bind l refresh-client
# bind | split-window
# bind s split-window -v -c "#{pane_current_path}"
# bind v split-window -h -c "#{pane_current_path}"
# bind '"' choose-window
# bind h select-pane -L
# bind j select-pane -D
# bind k select-pane -U
# bind l select-pane -R
# bind -r -T prefix , resize-pane -L 20
# bind -r -T prefix . resize-pane -R 20
# bind -r -T prefix - resize-pane -D 7
# bind -r -T prefix = resize-pane -U 7
# bind : command-prompt
# bind * setw synchronize-panes
# bind P set pane-border-status
# bind c kill-pane
# bind x swap-pane -D
# bind S choose-session
# bind-key -T copy-mode-vi v send-keys -X begin-selection
# bind-key -T copy-mode-vi V send-keys -X select-line
#
# set-option -g default-terminal 'screen-254color'
# set-option -g terminal-overrides ',xterm-256color:RGB'
#
# # Easy .config reload
# bind R source-file $HOME/..config/tmux/tmux.conf \; display-message "$HOME/..config/tmux/tmux.conf reloaded."
#
# # use C-a, since it's on the home row and easier to hit than C-b
# set-option -g prefix C-a
# unbind-key C-a
# bind-key C-a send-prefix
# set -g base-index 1
#
# # mouse behavior
# setw -g mouse on
#
# set -g detach-on-destroy off     # don't exit from tmux when closing a session
# set -g escape-time 0             # zero-out escape time delay
# set -g history-limit 1000000     # increase history size (from 2,000)
# set -g renumber-windows on       # renumber all windows when any window is closed
# set -g set-clipboard on          # use system clipboard
# set -g status-position top       # macOS / darwin style
# set -g default-terminal "${TERM}"
# setw -g mode-keys vi
# set -g pane-active-border-style 'fg=magenta,bg=default'
# set -g pane-border-style 'fg=brightblack,bg=default'
# set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'
# set -g @fzf-url-history-limit '3000'
#
# # set interval to set the status line update for tmux
# set -g status-interval 3
#
# bind-key L clear-history
#
# bind-key enter next-layout
# bind-key C-o rotate-window
#
# bind-key + select-layout main-horizontal
# bind-key = select-layout main-vertical
#
# bind-key a last-pane
# bind-key q display-panes
#
# bind-key [ copy-mode
# # bind-key ] paste-buffer
#
# # Setup 'v' to begin selection as in Vim
# bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
#
# # Update default binding of `Enter` to also use copy-pipe
# unbind -T copy-mode-vi Enter
# bind-key -T copy-mode-vi Enter send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
#
# # Enable native Mac OS X copy/paste
# set-option -g default-command "/bin/bash -c 'which reattach-to-user-namespace >/dev/null && exec reattach-to-user-namespace $SHELL -l || exec $SHELL -l'"
#
# # Allow the arrow key to be used immediately after changing windows
# set-option -g repeat-time 0
#
# bind-key Escape copy-mode			# enter copy mode; default [
# bind-key p paste-buffer				# paste; (default hotkey: ] )
# bind-key P choose-buffer 			# tmux clipboard history
# bind-key + delete-buffer \; display-message "Deleted current Tmux Clipboard History"
#
# # Send To Tmux Clipboard or System Clipboard
# bind-key < run-shell "tmux set-buffer -- \"$(xsel -o -b)\"" \; display-message "Copy To Tmux Clipboard"
# bind-key > run-shell 'tmux show-buffer | xsel -i -b' \; display-message "Copy To System Clipboard"
#
#
# bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe "xclip -in -selection clipboard"; \
# bind-key -T copy-mode-vi y send-keys -X copy-pipe "xclip -in -selection clipboard"
#
# # -----------------------------------------------------------------------------
# # Plugin Manager - https://github.com/tmux-plugins/tpm
# # If you didn't use my dotfiles install script you'll need to:
# #   Step 1) git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# #   Step 2) Reload tmux if it's already started with `r
# #   Step 3) Launch tmux and hit `I (capital i) to fetch any plugins
# # -----------------------------------------------------------------------------
#
# # List of plugins.
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'omerxx/tmux-sessionx'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-continuum'
# # set -g @plugin 'dreamsofcode-io/catppuccin-tmux'
# set -g @plugin 'omerxx/catppuccin-tmux'
# set -g @plugin 'sainnhe/tmux-fzf'
# set -g @plugin 'wfxr/tmux-fzf-url'
#
# set -g @sessionx-bind 'o'
# set -g @sessionx-x-path '~/session'
# set -g @sessionx-window-height '85%'
# set -g @sessionx-window-width '75%'
# set -g @sessionx-zoxide-mode 'on'
# set -g @continuum-restore 'on'
# set -g @resurrect-strategy-nvim 'session'
# set -g @catppuccin_window_left_separator ""
# set -g @catppuccin_window_right_separator " "
# set -g @catppuccin_window_middle_separator " █"
# set -g @catppuccin_window_number_position "right"
# set -g @catppuccin_window_default_fill "number"
# set -g @catppuccin_window_default_text "#W"
# set -g @catppuccin_window_current_fill "number"
# set -g @catppuccin_window_current_text "#W#{?window_zoomed_flag,(),}"
# set -g @catppuccin_status_modules_right "directory meetings date_time"
# set -g @catppuccin_status_modules_left "session"
# set -g @catppuccin_status_left_separator  " "
# set -g @catppuccin_status_right_separator " "
# set -g @catppuccin_status_right_separator_inverse "no"
# set -g @catppuccin_status_fill "icon"
# set -g @catppuccin_status_connect_separator "no"
# set -g @catppuccin_directory_text "#{b:pane_current_path}"
# set -g @catppuccin_meetings_text "#($HOME/..config/tmux/scripts/cal.sh)"
# set -g @catppuccin_date_time_text "%H:%M"
#
# # Initialize TPM (keep this line at the very bottom of your tmux.conf).
# run -b '~/.tmux/plugins/tpm/tpm'


# vim:ft=tmux
# tmux display things in 256 colors
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

set -g history-limit 20000

# automatically renumber tmux windows
set -g renumber-windows on

######################
#### General Settings ####
######################

 # set the prefix to control-a. This is more convenient than control-b
 # and 'a' is right next to Caps Lock (which I remap to control)
set -g prefix C-a
bind C-a send-prefix
bind-key a send-prefix

set -g set-clipboard on

# enable mouse support for switching panes/windows
setw -g mouse on

# make delay shorter
set -g escape-time 0
# make window/pane index start with 1
set -g base-index 1
setw -g pane-base-index 1
set-option -g focus-events on
set-option -g set-titles on

# set vi mode for copy mode
setw -g mode-keys vi
set -g status-keys vi

# automatically rename windows when an explicit name is not set
set-window-option -g automatic-rename on
set-option -g automatic-rename-format "#(nerdwin #{pane_current_command})"

# set the default title format
set-option -g set-titles-string "#T - #W"

# disabled activity monitoring
setw -g monitor-activity off
set -g visual-activity off

# Rather than constraining window size to the maximum size of any client
# connected to the *session*, constrain window size to the maximum size of any
# client connected to *that window*. Much more reasonable.
setw -g aggressive-resize on

######################
#### Key Bindings ####
######################

# keep CWD when opening new window
unbind c
bind c new-window -c "#{pane_current_path}"

# tile all windows
unbind =
bind = select-layout tiled

# reload .config file
bind r source-file ~/.config/tmux/tmux.conf \; display "Config Reloaded!"

# split window and fix path for tmux 1.9
bind v split-window -h -c "#{pane_current_path}"
bind s split-window -v -c "#{pane_current_path}"
bind ^c kill-pane
bind-key x rotate-window
bind C-o swap-pane -D

bind-key enter next-layout
bind-key C-o rotate-window

bind-key + select-layout main-horizontal
bind-key = select-layout main-vertical

# synchronize all panes in a window
bind * setw synchronize-panes

# pane movement shortcuts
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Resize pane shortcuts
bind -r , resize-pane -L 10
bind -r . resize-pane -R 10
bind -r ^j resize-pane -D 10
bind -r ^k resize-pane -U 10

# open lazygit in a new window
bind-key g display-popup -w "80%" -h "80%" -d "#{pane_current_path}" -E "lazygit"

# open btop in a new window
bind-key b display-popup -w "80%" -h "80%" -d "#{pane_current_path}" -E "btop"

# toggle the status bar
bind-key -T prefix T set-option -g status

set -g pane-active-border-style 'fg=magenta,bg=default'
set -g pane-border-style 'fg=brightblack,bg=default'
set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'
set -g @fzf-url-history-limit '3000'

unbind S 
bind S display-popup -B -E "\
  tmux list-sessions -F '#{?session_attached,,#{session_name}} ' |\
  sed '/^\s*$/d' |\
  fzf --reverse --header jump-to-session --color=border:#9991ab,spinner:#f5e0dc,hl:#f38ba8 \
--color=fg:#cdd6f4,header:#9991ab,info:#cba6f7,pointer:#f5e0dc \
--color=marker:#f5e0dc,fg+:#cdd6f4,prompt:#cba6f7,hl+:#f38ba8 |\
  xargs tmux switch-client -t"

# more settings to make copy-mode more vim-like
unbind [
bind Escape copy-mode
unbind p
bind p paste-buffer
bind -T copy-mode-vi v send -X begin-selection
bind P choose-buffer 			# tmux clipboard history


if-shell '[ "$(defaults read -g AppleInterfaceStyle 2>/dev/null)" = "Dark" ]' \
  'source-file "$HOME/.config/tmux/themes/catppuccin/mocha.conf"' \
  'source-file "$HOME/.config/tmux/themes/catppuccin/latte.conf"'

source-file "$HOME/.config/tmux/themes/catppuccin.conf"

# # -----------------------------------------------------------------------------
# # Plugin Manager - https://github.com/tmux-plugins/tpm
# # If you didn't use my dotfiles install script you'll need to:
# #   Step 1) git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# #   Step 2) Reload tmux if it's already started with `r
# #   Step 3) Launch tmux and hit `I (capital i) to fetch any plugins
# # -----------------------------------------------------------------------------
#
# # List of plugins.
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-continuum'
# set -g @plugin 'dreamsofcode-io/catppuccin-tmux'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'wfxr/tmux-fzf-url'
#
set -g @sessionx-bind 'o'
set -g @sessionx-x-path '~/session'
set -g @sessionx-window-height '85%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @continuum-restore 'on'
set -g @resurrect-strategy-nvim 'session'

# # Initialize TPM (keep this line at the very bottom of your tmux.conf).
run -b '~/.tmux/plugins/tpm/tpm'
